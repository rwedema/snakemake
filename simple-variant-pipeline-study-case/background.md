# Background

This tutorial is about a simple pipeline that maps the reads of a sample to a genome (yeast genome). It is of interest where the sample is different from the reference genome, the variants. By investigating the differences between all mapped reads and the reference sequence at one position, variants can be detected. This is a statistical challenge because they have to be distinguished from artifacts generated by the sequencing process. For the mapping, we will use `bwa` tool that generates a bam file. The bam file needs to be sorted using `samtools`. Next, we need to use `samtools` again to index the sorted read alignments for random access. The next step in our workflow will aggregate the mapped reads from all samples and jointly call genomic variants on them. For the variant calling, we will combine the two utilities `samtools` and `bcftools`. Finally we will report the outcome.

This tutorial will work you through the steps. After the basic script, you will be asked to improve the script by exercises. The improved script you need to upload to your repository.

If we build a pipeline for just for samples A and B it would look like this

```
bwa mem data/genome.fa data/samples/A.fastq | samtools view -Sb - > mapped_reads/A.bam
samtools sort -T sorted_reads/A -O bam mapped_reads/A.bam > sorted_reads/A.bam
samtools index sorted_reads/A.bam

bwa mem data/genome.fa data/samples/B.fastq | samtools view -Sb - > mapped_reads/B.bam
samtools sort -T sorted_reads/B -O bam mapped_reads/B.bam > sorted_reads/B.bam
samtools index sorted_reads/B.bam

samtools mpileup -g -f data/genome.fa sorted_reads/A.bam sorted_reads/B.bam | bcftools call -mv - > calls/all.vcf    
```

This bash script is not very flexible, it cannot run parallel and it is not flexible. We will change this into a snakemake script.
